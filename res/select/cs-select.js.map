{"version":3,"sources":["res/select/cs-select.js"],"names":[],"mappings":";;;gEAYa,QAAQ;;;;;;;;;;uCAZb,MAAM;8CAAE,aAAa;yCAAE,QAAQ;4CAAE,WAAW;;0BAC5C,GAAG;;;;;AAWE,oBAAQ;;;AAON,yBAPF,QAAQ,CAOL,EAAE,EAAE,GAAG,EACnB;;;;;;;;;;;AAEI,wBAAI,CAAC,OAAO,GAAK,EAAE,CAAC;AACpB,wBAAI,CAAC,GAAG,GAAS,GAAG,CAAC;AACrB,wBAAI,CAAC,MAAM,GAAM,KAAK,CAAC;AACvB,wBAAI,CAAC,SAAS,GAAG,EAAE,CAAC;iBACvB;;gCAdQ,QAAQ;;;;iCAEhB,QAAQ;;+BAAkB,IAAI;;;;;iCAC9B,QAAQ;;+BAAkB,KAAK;;;;;iCAC/B,QAAQ;;+BAAkB,IAAI;;;;;iCAC9B,QAAQ;;+BAAkB,IAAI;;;;;2BAc3B,cAAC,cAAc,EACnB;;;AACI,4BAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC;;AAEtB,4BAAI,CAAC,SAAS,GAAG,EAAE,CAAC,aAAa,CAAC,oBAAoB,CAAC,CAAC;AAIxD,0BAAE,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;AAC5B,0BAAE,CAAC,SAAS,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;;AAG9B,4BAAI,CAAC,aAAa,GAAG,AAAC,EAAE,CAAC,QAAQ,GAAG,CAAC,GAAI,CAAC,GAAG,EAAE,CAAC,QAAQ,CAAC;AACzD,4BAAI,CAAC,QAAQ,GAAQ,EAAE,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;AACjD,4BAAI,CAAC,QAAQ,GAAQ,QAAQ,CAAC,EAAE,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,CAAC;AACjE,4BAAI,CAAC,QAAQ,GAAQ,EAAE,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,MAAM,CAAC;AAC5D,4BAAI,CAAC,MAAM,GAAU,EAAE,CAAC,YAAY,CAAC,SAAS,CAAC,IAAM,IAAI,CAAC;AAI1D,4BAAG,CAAC,IAAI,CAAC,QAAQ,EACjB;AACI,8BAAE,CAAC,QAAQ,GAAI,IAAI,CAAC,aAAa,CAAC;yBACrC;;AAGD,4BAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,EAAI;AAAE,gCAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,EAAE,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC;yBAAI,MAC3D;AAAE,gCAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,EAAE,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,IAAI,GAAG,CAAC;yBAAE;;AAG1F,4BAAI,CAAC,YAAY,GAAK,UAAA,CAAC;mCAAI,MAAK,OAAO,CAAC,CAAC,CAAC;yBAAA,CAAC;AAC3C,4BAAI,CAAC,YAAY,GAAK,UAAA,CAAC;mCAAI,MAAK,OAAO,CAAC,CAAC,CAAC;yBAAA,CAAC;AAC3C,4BAAI,CAAC,WAAW,GAAM,UAAA,CAAC;mCAAI,MAAK,MAAM,CAAC,CAAC,CAAC;yBAAA,CAAC;AAC1C,4BAAI,CAAC,cAAc,GAAG,UAAA,CAAC;mCAAI,MAAK,SAAS,CAAC,CAAC,CAAC;yBAAA,CAAC;;AAE7C,0BAAE,CAAC,gBAAgB,CAAC,OAAO,EAAI,IAAI,CAAC,YAAY,CAAC,CAAC;AAClD,0BAAE,CAAC,gBAAgB,CAAC,OAAO,EAAI,IAAI,CAAC,YAAY,CAAC,CAAC;AAClD,0BAAE,CAAC,gBAAgB,CAAC,MAAM,EAAK,IAAI,CAAC,WAAW,CAAC,CAAC;AACjD,0BAAE,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;;AAEpD,4BAAI,CAAC,aAAa,EAAE,CAAC;qBACxB;;;2BACK,kBACN;AACI,4BAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC;AACtB,0BAAE,CAAC,mBAAmB,CAAC,OAAO,EAAI,IAAI,CAAC,YAAY,CAAC,CAAC;AACrD,0BAAE,CAAC,mBAAmB,CAAC,OAAO,EAAI,IAAI,CAAC,YAAY,CAAC,CAAC;AACrD,0BAAE,CAAC,mBAAmB,CAAC,MAAM,EAAK,IAAI,CAAC,WAAW,CAAC,CAAC;AACpD,0BAAE,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;qBAC1D;;;2BAOM,iBAAC,GAAG,EACX;AACI,4BAAG,IAAI,CAAC,QAAQ,EAAE;AAAE,mCAAO;yBAAE;;AAE7B,4BAAI,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,kBAAkB,CAAC,EAC/C;AACI,oCAAI,CAAC,KAAK,EAAE,CAAC,AAAC,OAAO;6BACxB;AACD,4BAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;qBACvB;;;2BAEM,mBACP;AACI,4BAAG,IAAI,CAAC,QAAQ,EAAE;AAAE,gCAAI,CAAC,MAAM,EAAE,CAAC,AAAC,OAAO;yBAAE;AAC5C,4BAAI,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;qBACzC;;;2BAEK,kBACN;AACI,4BAAI,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;qBAC5C;;;2BAEQ,mBAAC,GAAG,EACb;AACI,4BAAI,IAAI,CAAC,QAAQ,EAAE;AAAE,mCAAO;yBAAE;;AAE9B,4BAAI,GAAG,CAAC,OAAO,KAAK,GAAG,CAAC,OAAO,CAAC,EAAE,IAAI,GAAG,CAAC,OAAO,KAAK,GAAG,CAAC,OAAO,CAAC,IAAI,IAAI,GAAG,CAAC,iBAAiB,CAAC,GAAG,CAAC,OAAO,CAAC,EAC5G;AACI,gCAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;yBACvB;qBACJ;;;2BAQc,yBAAC,MAAM,EACtB;AACI,4BAAI,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC;AACtB,4BAAG,MAAM,EACT;AACI,8BAAE,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;AAC7B,8BAAE,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;yBAEpB,MAED;AACI,8BAAE,CAAC,SAAS,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;AAChC,8BAAE,CAAC,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC;yBACpC;qBACJ;;;2BAEW,sBAAC,MAAM,EACnB;AACI,4BAAI,CAAC,aAAa,EAAE,CAAC;qBACxB;;;2BAKI,iBACL;AACI,4BAAI,CAAC,KAAK,GAAG,IAAI,CAAC;AAClB,4BAAI,CAAC,aAAa,EAAE,CAAC;qBACxB;;;2BAEW,sBAAC,CAAC,EACd;AACI,4BAAI,CAAC,MAAM,GAAG,CAAC,CAAC;;AAEhB,4BAAG,CAAC,EAAE;AAAE,gCAAI,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;yBAAE,MACvC;AAAE,gCAAI,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;yBAAE;qBACnD;;;2BAEgB,2BAAC,CAAC,EACnB;AACI,4BAAI,CAAC,KAAK,GAAG,CAAC,CAAC;AACf,4BAAI,CAAC,aAAa,EAAE,CAAC;qBACxB;;;2BAEY,yBACb;AACI,4BAAI,MAAM;4BAAG,GAAG,GAAG,IAAI,CAAC,KAAK;4BAAE,EAAE;4BAAE,GAAG,CAAC;AACvC,4BAAG,GAAG,EACN;AACI,8BAAE,GAAI,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,EACtB,GAAG,GAAG,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;yBAC5B;;AAED,4BAAG,IAAI,CAAC,YAAY,EACpB;AACI,sCAAM,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,EAAE,EAAE,EAAE,GAAG,CAAC,CAAC;6BAC5C,MAED;AACI,sCAAM,GAAG,GAAG,GAAG,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC;6BAC3C;AACD,4BAAI,CAAC,SAAS,CAAC,SAAS,GAAG,MAAM,CAAC;qBACrC;;;AA/KQ,wBAAQ,GANpB,QAAQ,CAAC,EAAC,IAAI,EAAO,OAAO;AAClB,6BAAS,EAAE,OAAO;AAClB,iCAAa,EAAE,cAAc;AAC7B,sCAAkB,EAAE,WAAW,CAAC,MAAM;AACtC,gCAAY,EAAE,SAAS;iBACjC,CAAC,CACW,QAAQ,KAAR,QAAQ;AAAR,wBAAQ,GAPpB,aAAa,CAAC,WAAW,CAAC,CAOd,QAAQ,KAAR,QAAQ;AAAR,wBAAQ,GARpB,MAAM,CAAC,OAAO,EAAC,GAAG,CAAC,CAQP,QAAQ,KAAR,QAAQ;uBAAR,QAAQ;;;gCAAR,QAAQ","file":"res/select/cs-select.js","sourcesContent":["import {inject, customElement, bindable, bindingMode} from 'aurelia-framework';  \r\nimport {DDL} from '../ddl/ddl';\r\nimport * as chs from '../chs';\r\n\r\n@inject(Element,DDL)\r\n@customElement('cs-select')\r\n@bindable({name     : 'value',                            //Selected value object\r\n           attribute: 'value',\r\n           changeHandler: 'valueChanged',\r\n           defaultBindingMode: bindingMode.twoWay,\r\n           defaultValue: undefined\r\n})\r\nexport class CsSelect\r\n{\r\n    @bindable src            = null;   //Item source for results\r\n    @bindable disabled       = false;  //Is the control disabled?\r\n    @bindable renderItemFn   = null;   //Custom function for rendering item content.   Ex: renderItem(obj, id, txt)\r\n    @bindable renderResultFn = null;   //Custom function for rendering result content. Ex: renderResult(ddl, ctrl, obj, highlightedMarkup)\r\n\r\n    constructor(el, ddl)\r\n    {\r\n        //Set control properties\r\n        this.element   = el;       \r\n        this.ddl       = ddl;          //Global singleton drop down list\r\n        this.isOpen    = false;        //Is drop down open?\r\n        this.lastInput = \"\";           //Stores last input entered into the control (ddl uses & sets this)\r\n    }\r\n\r\n\r\n    //Lifecycle hooks\r\n    //-------------------------------------------------------------------------------------------------------------------------------------------\r\n    bind(bindingContext)   //Invoked when the databinding engine binds the view. The binding context is the instance that the view is databound to. (All properties have their initial bound values set)\r\n    {\r\n        var el = this.element;\r\n        \r\n        this.contentEl = el.querySelector(\".cs-select-content\");          //Div that holds the control's current value content\r\n\r\n\r\n        //Added classes to the element\r\n        el.classList.add(\"cs-ctrl\");                                      //Every cs control has this to idenify them             \r\n        el.classList.add(\"cs-select\");                                    //Style select control\r\n        \r\n\r\n        this.savedTabIndex = (el.tabIndex < 0) ? 0 : el.tabIndex;          //Record any tabIndex set on the control element.\r\n        this.required      = el.hasAttribute(\"required\");                  //Record if this is a required field or is nullable\r\n        this.minChars      = parseInt(el.getAttribute(\"min-chars\")) || 0;  //Min chars that need to be typed before querying\r\n        this.textProp      = el.getAttribute(\"text-prop\") || \"text\";       //Object property to use for text\r\n        this.idProp        = el.getAttribute(\"id-prop\")   || \"id\";         //Object property to use for the ID\r\n\r\n\r\n        //Ensure the control is tabbable (unless the control is disabled)\r\n        if(!this.disabled)\r\n        {\r\n            el.tabIndex  = this.savedTabIndex;\r\n        }\r\n        \r\n        //Milli-seconds to delay querying. If non specified use 0 delay for array data source and 200ms for others sources.\r\n        if (Array.isArray(this.src))   { this.delay = parseInt(el.getAttribute(\"delay\")) || 0;   }\r\n        else                           { this.delay = parseInt(el.getAttribute(\"delay\")) || 200; }\r\n\r\n        //Bind events\r\n        this.clickHandler   = e => this.onClick(e);\r\n        this.focusHandler   = e => this.onFocus(e);\r\n        this.blurHandler    = e => this.onBlur(e);\r\n        this.keydownHandler = e => this.onKeyDown(e);\r\n\r\n        el.addEventListener(\"click\",   this.clickHandler);\r\n        el.addEventListener(\"focus\",   this.focusHandler);\r\n        el.addEventListener(\"blur\",    this.blurHandler);\r\n        el.addEventListener(\"keydown\", this.keydownHandler);\r\n\r\n        this.renderContent();\r\n    }\r\n    unbind()   //Called when the databinding engine unbinds the view\r\n    {\r\n        var el = this.element;\r\n        el.removeEventListener(\"click\",   this.clickHandler);\r\n        el.removeEventListener(\"focus\",   this.focusHandler);\r\n        el.removeEventListener(\"blur\",    this.blurHandler);\r\n        el.removeEventListener(\"keydown\", this.keydownHandler);\r\n    }\r\n    \r\n\r\n\r\n\r\n    //Event handlers\r\n    //-------------------------------------------------------------------------------------------------------------------------------------------\r\n    onClick(evt)\r\n    {\r\n        if(this.disabled) { return; }\r\n\r\n        if (chs.closest(evt.target, \".cs-select-clear\"))   //If clear button was clicked\r\n        {\r\n            this.clear(); return;\r\n        }\r\n        this.ddl.open(this);\r\n    }\r\n\r\n    onFocus()\r\n    {\r\n        if(this.disabled) { this.onBlur(); return; }\r\n        this.element.classList.add(\"focused\");\r\n    }\r\n\r\n    onBlur()\r\n    {\r\n        this.element.classList.remove(\"focused\");\r\n    }\r\n\r\n    onKeyDown(evt)\r\n    {\r\n        if (this.disabled) { return; }\r\n\r\n        if (evt.keyCode === chs.keyCode.UP || evt.keyCode === chs.keyCode.DOWN || chs.isAlphaNumericKey(evt.keyCode))\r\n        {\r\n            this.ddl.open(this);\r\n        }\r\n    }\r\n\r\n    \r\n\r\n\r\n\r\n    //Binding change handlers\r\n    //-------------------------------------------------------------------------------------------------------------------------------------------\r\n    disabledChanged(newVal)\r\n    {\r\n        var el = this.element;\r\n        if(newVal)\r\n        {\r\n            el.classList.add(\"disabled\");\r\n            el.tabIndex = -1;                  //Prevent tabbing\r\n            \r\n        }\r\n        else\r\n        {\r\n            el.classList.remove(\"disabled\");\r\n            el.tabIndex = this.savedTabIndex;  //Enable tabbing\r\n        }\r\n    }\r\n\r\n    valueChanged(newVal)\r\n    {\r\n        this.renderContent();\r\n    }\r\n\r\n\r\n    //Actions\r\n    //-------------------------------------------------------------------------------------------------------------------------------------------\r\n    clear()\r\n    {\r\n        this.value = null;\r\n        this.renderContent();\r\n    }\r\n\r\n    setOpenState(b)  //Called by ddl\r\n    {\r\n        this.isOpen = b;\r\n\r\n        if(b) { this.element.classList.add(\"open\"); }\r\n        else  { this.element.classList.remove(\"open\"); }\r\n    }\r\n\r\n    addSelectedResult(o)  //Called by ddl when result item selected\r\n    {\r\n        this.value = o;\r\n        this.renderContent();\r\n    }\r\n\r\n    renderContent()\r\n    {\r\n        var markup,  obj = this.value, id, txt;\r\n        if(obj)\r\n        {\r\n            id  = obj[this.idProp], \r\n            txt = obj[this.textProp];\r\n        }\r\n\r\n        if(this.renderItemFn)   //If a custom item render() supplied call it to generate the markup to render\r\n        {\r\n            markup = this.renderItemFn(obj, id, txt);\r\n        }\r\n        else                    //Use default rendering (just display selected item's \"text\" property\r\n        {\r\n            markup = obj ? chs.encodeHtml(txt) : \"\";\r\n        }\r\n        this.contentEl.innerHTML = markup;\r\n    }\r\n}"],"sourceRoot":"/source/"}