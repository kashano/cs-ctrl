{"version":3,"sources":["res/ddl/ddl.js"],"names":[],"mappings":"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","file":"res/ddl/ddl.js","sourcesContent":["import * as chs from '../chs';\r\n\r\nvar ResultClass = \"cs-ddl-result\",\r\n    FocusClass  = \"cs-focus\";\r\n\r\n\r\n//Singleton Dropdown list class\r\n//----------------------------------------------------------------------------------------\r\nexport class DDL  \r\n{\r\n    constructor()\r\n    {\r\n        this.curCtrl      = null;        //Stores a reference to the current control this DDL is working with\r\n        this.queryTimerID = 0;           //setTimeout ID for the query\r\n\r\n\r\n        //Create & store drop down list elements\r\n        var doc           = document;\r\n        this.ddlEl        = doc.createElement(\"div\");    //Dropdown list\r\n        this.inputEl      = doc.createElement(\"input\");  //Input inside DDL\r\n        this.inputElWrap  = doc.createElement(\"div\");    //Wraps the input\r\n        this.inputIco     = doc.createElement(\"div\");    //Icon inside the input wrap\r\n        this.resultsEl    = doc.createElement(\"ul\");     //Results inside DDL\r\n        this.ddlElMsg     = doc.createElement(\"div\");    //Message below the results\r\n\r\n        //Add classes to them\r\n        this.ddlEl.className        = 'cs-ddl cs-hidden';\r\n        this.inputEl.className      = 'cs-ddl-input';\r\n        this.inputElWrap.className  = 'cs-ddl-input-wrap';\r\n        this.inputIco.className     = 'cs-ddl-input-ico';\r\n        this.resultsEl.className    = 'cs-ddl-results';\r\n        this.ddlElMsg.className     = 'cs-ddl-msg';\r\n\r\n        //Assemble them and append ddl to body\r\n        this.inputElWrap.appendChild(this.inputEl);\r\n        this.inputElWrap.appendChild(this.inputIco);\r\n        this.ddlEl.appendChild(this.inputElWrap);\r\n        this.ddlEl.appendChild(this.resultsEl);\r\n        this.ddlEl.appendChild(this.ddlElMsg);\r\n        \r\n        doc.body.appendChild(this.ddlEl);\r\n\r\n        \r\n        //Wire document events\r\n        doc.addEventListener('wheel', (evt) =>\r\n        {\r\n            if(!chs.closest(evt.target, \".cs-ddl\"))  //Iff scrolling isn't on the DDL, close it\r\n            {\r\n                this.hideDDL();\r\n            }\r\n        });\r\n\r\n\r\n        doc.addEventListener('mousedown', (evt) =>\r\n        {\r\n            if (!this.curCtrl) { return; }\r\n\r\n            var ctrlEl = this.curCtrl.element, target = evt.target;\r\n\r\n            if (ctrlEl.contains(target))                           //If click was on the active control\r\n            {\r\n                if (this.curCtrl.disabled) { this.hideDDL();    }  //If click was on a disabled ctrl close DDL on any previously opened ctrl\r\n                else                       { this.focusInput(); }\r\n            }\r\n            else if (this.ddlEl.contains(target))                  //If click was on the DDL\r\n            {\r\n                var clickedResult = chs.closest(target, \".\" + ResultClass);\r\n                if (clickedResult)\r\n                {\r\n                    this.resultsEl.querySelector(\".\" + FocusClass).classList.remove(FocusClass);   //Clear prev selected result\r\n                    clickedResult.classList.add(FocusClass);                                       //Select clicked result\r\n                    this.addSelectedResult();\r\n                }\r\n                else { this.focusInput(); }\r\n                \r\n            }\r\n            else { this.hideDDL(); }                               //Otherwise, close DDL\r\n        });\r\n        \r\n\r\n        //Wire input events\r\n        this.inputEl.addEventListener('keydown', (e) => this.onInputKeyDown(e));\r\n        this.inputEl.addEventListener('keyup',   (e) => this.onInputKeyUp(e));\r\n    }\r\n\r\n    open(ctrl)\r\n    {\r\n        if (ctrl !== this.curCtrl)             //If a new ctrl is being opened...\r\n        {\r\n            if (this.curCtrl !== null)         //Set previously active ctrl to closed\r\n            {\r\n                this.curCtrl.setOpenState(false);\r\n            }   \r\n            this.curCtrl = ctrl;               //Switch to new ctrl\r\n            this.clearDDL();\r\n        }\r\n        \r\n        if (!this.curCtrl.disabled) { this.queryIfAllowedAndEnsureDDLVisible(); }\r\n    }\r\n\r\n    focusInput()\r\n    {\r\n        setTimeout(()=> this.inputEl.focus(), 1);\r\n    }\r\n\r\n    clearDDL()\r\n    {\r\n        var c = this.curCtrl;\r\n        this.resultsEl.innerHTML = '';\r\n        this.inputEl.value = \"\";\r\n        if (c) \r\n        { \r\n            c.lastInput       = \"\"; \r\n            c.filteredResults = null;\r\n        }\r\n    }\r\n\r\n    showDDL()\r\n    {\r\n        this.ddlEl.classList.remove(\"cs-hidden\");\r\n        this.positionDDL();\r\n        this.curCtrl.setOpenState(true);\r\n        this.focusInput();\r\n    }\r\n\r\n    hideDDL()\r\n    {\r\n        this.ddlEl.classList.add(\"cs-hidden\");\r\n        if (this.curCtrl) { this.curCtrl.setOpenState(false); }\r\n    }\r\n\r\n    positionDDL()\r\n    {\r\n        var ctrlEl      = this.curCtrl.element,         //The DOM element for the control we are attaching this DDL to\r\n            ctrlPos     = chs.jqOffset(ctrlEl),         //Coordinates relative to the document\r\n            borderTop   = false,                        //DDL will either have a top or bottom border. (Depending on if it's positioned above or below the ctrl)\r\n            ddl         = this.ddlEl,                   //The DDL element\r\n            ctrlHeight  = ctrlEl.offsetHeight,          //Height the contrll we're attached to\r\n            y           = ctrlPos.top + ctrlHeight,     //Y position directly below ctrl\r\n            wh          = window.innerHeight,           //Height of the browser viewport including, if rendered, the horizontal scrollbar\r\n            topSpace    = ctrlPos.top,                  //Space available above ctrl\r\n            botSpace    = (wh - y),                     //Space available below ctrl\r\n            maxSpace    = Math.max(botSpace, topSpace); //Size of the larger space\r\n            \r\n\r\n        //Set ddl left position / width\r\n        ddl.style.left   = ctrlPos.left + 'px';\r\n        ddl.style.width  = ctrlEl.offsetWidth + 'px';\r\n        \r\n        //Set scrollable area max-height\r\n        var scrollHeight = maxSpace - 45;                         //Subtract a bit to account for the input control and padding\r\n        this.resultsEl.style.maxHeight = scrollHeight + 'px';\r\n\r\n        //If ddl would extend beyond the window assume it's better to show above the control *IF* topSpace has more room\r\n        if ((y + ddl.offsetHeight) > wh) \r\n        {\r\n            if (topSpace > botSpace) //Top space has more room so put ddl above the ctrl\r\n            {\r\n                borderTop = true;\r\n                y = ctrlPos.top - ddl.offsetHeight - 1;   //Position if above control (may not have ddl height correct @ this point, may need to cal again after results render)\r\n            }\r\n        }\r\n \r\n        //Set DDL top position\r\n        ddl.style.top = y + 'px';\r\n        \r\n        //Assign top/bottom border\r\n        if(borderTop)\r\n        {\r\n            ddl.style.borderTopStyle    = 'solid';\r\n            ddl.style.borderBottomStyle = 'none';\r\n        }\r\n        else\r\n        {\r\n            ddl.style.borderBottomStyle = 'solid';\r\n            ddl.style.borderTopStyle    = 'none';\r\n        }\r\n    }\r\n\r\n    setMsg(markup) \r\n    { \r\n        this.ddlElMsg.innerHTML = markup; \r\n    }\r\n\r\n    showBusy(b)\r\n    {\r\n        if (b) { this.inputElWrap.classList.add(\"cs-busy\");    }\r\n        else   { this.inputElWrap.classList.remove(\"cs-busy\"); }\r\n    }\r\n\r\n\r\n    queryIfAllowedAndEnsureDDLVisible()\r\n    {\r\n        if (this.canQuery())\r\n        {\r\n            this.queryTimerID = setTimeout(() => this.doQuery(), this.curCtrl.delay);\r\n        }\r\n        if (!this.curCtrl.isOpen) { this.showDDL(); }\r\n    }\r\n\r\n\r\n\r\n    canQuery()\r\n    {\r\n        var charsNeeded = this.curCtrl.minChars - this.inputEl.value.length;\r\n\r\n        this.cancelQuery();\r\n\r\n        if (charsNeeded > 0)\r\n        {\r\n            this.setMsg(\"Enter \" + charsNeeded + \" more character(s)\");\r\n            return false;\r\n        }\r\n\r\n        this.showBusy(true);\r\n        return true;\r\n    }\r\n\r\n    cancelQuery()\r\n    {\r\n        this.setMsg(\"\");                                                //Remove working message\r\n        if (this.queryTimerID) { clearTimeout(this.queryTimerID); }     //Stop query from running\r\n    }\r\n\r\n    doQuery()\r\n    {\r\n        var searchTxt   = this.inputEl.value,\r\n            lcSearchTxt = searchTxt.toLowerCase(),\r\n            c           = this.curCtrl,\r\n            results;\r\n\r\n        \r\n        //Process result source...\r\n        var isFunc = chs.isFunc(c.src);                          //Check if control's data source is a function\r\n        results    = isFunc ? c.src(searchTxt) : c.src;          //If it's a function run it passing the searchTxt, otherwise take the value as is.\r\n        if(!results.then) {results = Promise.resolve(results);}  //Ensure results are a promise if not already.\r\n        \r\n      \r\n        //Clear any current filtered results\r\n        c.filteredResults = null;   //Null tells renderResults() that results are pending.\r\n        this.renderResults();\r\n\r\n        var self = this;\r\n\r\n        //When promise has resolved\r\n        results.then( (r) =>\r\n        {\r\n            if(isFunc)    //Assume if resultSrc was a function filtering of results has already been done.\r\n            {\r\n                c.filteredResults = r;\r\n            }\r\n            else          //If resultSrc wasn't a function perform basic filtering of results now\r\n            {\r\n                c.filteredResults = [];\r\n                for (var i = 0; i < r.length; i++)\r\n                {\r\n                    if (r[i][c.textProp].containsWords(lcSearchTxt)) { c.filteredResults.push(r[i]); }\r\n                }\r\n            }\r\n            self.renderResults();\r\n        });\r\n    }\r\n\r\n    renderResults()\r\n    {\r\n        var c = this.curCtrl, d = c.filteredResults, markup, i = 1;\r\n        \r\n        //Check we're OK to display results\r\n        if (!this.canQuery()) { return; }\r\n\r\n        //Reposition the DDL after rendering, so position code knows the new height of the DDL\r\n        setTimeout(() => this.positionDDL(), 0);\r\n        \r\n        //If d is undefined...results are still pending\r\n        if (!d)\r\n        {\r\n            this.showBusy(true);\r\n            return;\r\n        }\r\n\r\n        //Clear results and any message\r\n        this.setMsg(\"\");\r\n        this.resultsEl.innerHTML = '';\r\n        this.showBusy(false);\r\n\r\n\r\n        //If this is a control supporting multiple selected values, remove results that have already been selected\r\n        if (c.values)\r\n        {\r\n            d.chsRemoveMatchingElements(c.idProp, c.values);\r\n        }\r\n\r\n        //Handle No Results\r\n        if (d.length < 1) { this.setMsg(\"No matches\"); return; }\r\n\r\n        //Add 1st result as being \"focused/selected\"\r\n        markup = \"<li class='cs-ddl-result cs-focus' data-id='\" + d[0][c.idProp] + \"'><div class='cs-ddl-result-content'>\" + this.renderResultContent(this, c, d[0]) + \"</div></li>\";\r\n\r\n        //Add the reamining results\r\n        for (; i < d.length; i++)\r\n        {\r\n            markup += \"<li class='cs-ddl-result' data-id='\" + d[i][c.idProp] + \"'><div class='cs-ddl-result-content'>\" + this.renderResultContent(this, c, d[i]) + \"</div></li>\";\r\n        }\r\n        this.resultsEl.innerHTML = markup;\r\n    }\r\n\r\n\r\n    renderResultContent(ddl, ctrl, obj)\r\n    {\r\n        var highlightedMarkup = ddl.getHighlightedMarkup(obj[ctrl.textProp]);                      //Get highlighted version of the object's text property\r\n\r\n        if(ctrl.renderResultFn) {return ctrl.renderResultFn(ddl, ctrl, obj, highlightedMarkup); }  //If control has a custom render function for results run in and return results\r\n        return highlightedMarkup;                                                                  //Otherwise just return the highlighted text\r\n    }\r\n\r\n\r\n    getHighlightedMarkup(txt)\r\n    {\r\n        var searchTxt = this.inputEl.value.toLowerCase(),\r\n            searchLen = searchTxt.length,\r\n            matchIx   = txt.toLowerCase().indexOf(searchTxt),\r\n            markup;\r\n            \r\n        if (matchIx < 0 || searchTxt.length < 1) { return chs.encodeHtml(txt); }\r\n\r\n        markup = chs.encodeHtml(txt.substring(0, matchIx)) +\r\n                \"<span class='cs-ddl-result-highlight'>\" +\r\n                chs.encodeHtml(txt.substring(matchIx, matchIx + searchLen)) +\r\n                \"</span>\" +\r\n                chs.encodeHtml(txt.substring(matchIx + searchLen));\r\n\r\n        return markup;\r\n    }\r\n\r\n\r\n    onInputKeyDown(evt)\r\n    {\r\n        var c = this.curCtrl, isOpen = c.isOpen, resultsEl = this.resultsEl, results, selectedResult, ix, newRes;\r\n\r\n        switch (evt.keyCode)\r\n        {\r\n            case 40:  //Down\r\n                if (isOpen)\r\n                {\r\n                    results = resultsEl.querySelectorAll(\".\" + ResultClass);          //Get results\r\n                    if(!results.length) {return false;}\r\n\r\n                    selectedResult = resultsEl.querySelector(\".\" + FocusClass);       //Get currently selected result\r\n                    selectedResult.classList.remove(FocusClass);                      //Remove selection class from prev selection\r\n\r\n                    ix = getIndexOfNode(results, selectedResult) + 1;                 //Get index after selected result\r\n                    if (ix >= results.length) { ix = 0; }                             //Wrap around as necessary\r\n                    \r\n                    newRes = results[ix];                                             //Get new result\r\n                    newRes.classList.add(FocusClass);                                 //Add selection class to newly selected result\r\n\r\n                    if (!isInView(resultsEl, newRes, true))                           //If not totally visible, scroll to it\r\n                    {\r\n                        resultsEl.scrollTop = (newRes.offsetTop - resultsEl.offsetTop) + (newRes.offsetHeight - resultsEl.offsetHeight);\r\n                    }\r\n                    \r\n                    return false;\r\n                }\r\n                c.lastInput = \"\";  //Cause prev input to not match current (which will cause a query on keyUp)\r\n                return;\r\n                \r\n            case 38:  //Up\r\n                if (isOpen)\r\n                {\r\n                    results        = resultsEl.querySelectorAll(\".\" + ResultClass);   //Get results\r\n                    if(!results.length) {return false;}\r\n\r\n                    selectedResult = resultsEl.querySelector(\".\" + FocusClass);       //Get currently selected result\r\n                    selectedResult.classList.remove(FocusClass);                      //Remove selection class from prev selection\r\n\r\n                    ix = getIndexOfNode(results, selectedResult) - 1;                 //Get index before selected result\r\n                    if (ix < 0) { ix = (results.length - 1); }                        //Wrap around as necessary\r\n                    \r\n                    newRes = results[ix];                                             //Get new result\r\n                    newRes.classList.add(FocusClass);                                 //Add selection class to newly selected result\r\n\r\n                    if (!isInView(resultsEl, newRes, true))                           //If not totally visible, scroll to it\r\n                    {\r\n                        resultsEl.scrollTop = newRes.offsetTop - resultsEl.offsetTop;\r\n                    }\r\n                    \r\n                    return false;\r\n                }\r\n                return;\r\n\r\n            case 27:  //ESC\r\n                if (isOpen)\r\n                {\r\n                    this.hideDDL(); c.element.focus();\r\n                    return false;\r\n                }\r\n                return;\r\n                \r\n            case 13:  //Enter\r\n                if (isOpen) { this.addSelectedResult(); return false; }\r\n                return;\r\n                \r\n            case 9:  //Tab\r\n                evt.preventDefault();\r\n                this.hideDDL();\r\n                this.curCtrl.element.focus();\r\n                return false;\r\n        }\r\n    }\r\n\r\n    onInputKeyUp(evt)\r\n    {\r\n        var currentInput = this.inputEl.value;\r\n\r\n        switch (evt.keyCode)\r\n        {\r\n            case  9:  //Tab\r\n            case 13:  //Enter\r\n            case 27:  //Esc\r\n                return;\r\n        }\r\n\r\n        if (this.curCtrl.lastInput !== currentInput)   //Attempt a query if input has changed\r\n        {\r\n            this.curCtrl.lastInput = currentInput;\r\n            this.queryIfAllowedAndEnsureDDLVisible();\r\n        }\r\n    }\r\n\r\n    \r\n\r\n    addSelectedResult()\r\n    {\r\n        var result          = this.resultsEl.querySelector(\".\" + FocusClass),\r\n            id              = Number(result.dataset.id),  //read data-id attribue\r\n            obj             = null,\r\n            c               = this.curCtrl,\r\n            filteredResults = c.filteredResults;\r\n        \r\n        //Search thru filtered result objects to grab the one w/ the id matching the id on the selected result element\r\n        for (var i = 0; i < filteredResults.length; i++) \r\n        {\r\n            if (filteredResults[i][c.idProp] === id) { obj = filteredResults[i]; break; }\r\n        }\r\n\r\n        if (obj === null) { return; }\r\n        \r\n        this.hideDDL();\r\n        c.addSelectedResult(obj);\r\n\r\n        setTimeout(()=>c.element.focus(), 1);\r\n    }\r\n}\r\n\r\n\r\n\r\nfunction getIndexOfNode(nodeList, node)  //returns the index of the node in the nodelist\r\n{\r\n    for(var i = 0; i < nodeList.length; i++)\r\n    {\r\n        if(nodeList[i] === node) { return i; }\r\n    }\r\n    return -1;\r\n}\r\n\r\n\r\nfunction isInView(container, el, fullyInView)   //Simplistic check if element is visible when inside a vertically scrolling parent\r\n{\r\n    var containerTop    = container.scrollTop,\r\n        containerBottom = containerTop + container.offsetHeight,\r\n        elTop           = chs.jqOffset(el).top + containerTop;\r\n\r\n    if(container !== window)\r\n    {\r\n        elTop -= chs.jqOffset(container).top;\r\n    }\r\n\r\n\r\n    var elBottom = elTop + el.offsetHeight;\r\n    if (fullyInView)\r\n    {\r\n        return ((containerTop <= elTop) && (containerBottom >= elBottom));  //Is element fully visible?\r\n    }\r\n    return ((elBottom >= containerTop) && (elTop <= containerBottom));    //Is element visible at all?\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"sourceRoot":"/source/"}